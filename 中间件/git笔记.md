# git的使用

## 1.提交文件到远程仓库




## git基础知识

![https://image.itbaima.net/images/173/image-20231012129927140.png](https://image.itbaima.net/images/173/image-20231012129927140.png)





### 1.1 `.gitignore` 的文件

创建一个名为 `.gitignore` 的文件，用来指定 Git 忽略哪些文件和文件夹，这些被忽略的文件将不会被纳入版本控制。

以下是如何编写 `.gitignore` 文件的基本步骤：

1. **创建 `.gitignore` 文件**：首先，在你的 Git 项目根目录下创建一个名为 `.gitignore` 的文件。

2. **编辑 `.gitignore` 文件**：使用文本编辑器打开 `.gitignore` 文件，然后添加忽略规则。每个规则通常占据一行。

3. **编写忽略规则**：忽略规则遵循一些基本的模式匹配规则。以下是一些示例规则：

   - 忽略单个文件：要忽略一个特定文件，只需在 `.gitignore` 文件中添加文件名即可，例如：`file.txt`
   - 忽略特定文件类型：要忽略特定类型的文件，可以使用通配符 `*`，例如：`*.log` 将忽略所有 `.log` 文件。
   - 忽略整个文件夹：要忽略整个文件夹及其内容，可以在 `.gitignore` 中添加文件夹名称，例如：`myfolder/`
   - 使用斜杠 `/` 分隔路径：你可以指定相对于 `.gitignore` 文件所在目录的路径，例如：`folder/subfolder/`
   - 使用 `#` 添加注释：你可以在 `.gitignore` 文件中使用 `#` 符号添加注释，以提供说明或注解。

   ~~~sh
   *.txt  ，*.xls  表示过滤某种类型的文件
   target/ ：表示过滤这个文件夹下的所有文件
   /test/a.txt ，/test/b.xls  表示指定过滤某个文件下具体文件
   !*.java , !/dir/test/     !开头表示不过滤
   *.[ab]    支持通配符：过滤所有以.a或者.b为扩展名的文件
   /test  仅仅忽略项目根目录下的 test 文件，不包括 child/test等非根目录的test目录
   ~~~

   可以使用一个通配符来一次性忽略所有`.idea`文件夹，以及其中的内容。你可以在项目的根目录下的`.gitignore`文件中添加如下一行：
   
   ```
   **/.idea/
   ```
   
   这将递归地忽略所有项目中名为`.idea`的文件夹，不管它们在项目的哪个子目录中。这个通配符将匹配任何目录下的`.idea`文件夹，并将其排除在版本控制之外。不需要为每个子目录都单独设置忽略规则。

下面是一个示例 `.gitignore` 文件的内容：

```sh
plaintextCopy code# 忽略所有 .log 文件
*.log

# 忽略 build 文件夹及其内容
/build/

# 忽略 .env 文件
.env
```

1. **保存文件**：保存 `.gitignore` 文件。

一旦你编写了 `.gitignore` 文件并将其保存到项目根目录，Git 将在执行 `git add` 和 `git commit` 操作时自动忽略 `.gitignore` 中指定的文件和目录。

### 1.2 head

head指向分支（如：master），master指向具体的版本号

### 其他注意事项

1. 空文件夹(一个工作空间、工作区)不会被git追踪，必须要有文件才可以
2. 一个github仓库只要有一个.git文件夹即可，其他文件夹的.git文件夹会导致在github上有.git的文件夹不能查看里面的内容

## 2.常用命令：

### 2.1 配置类:

查看当前配置的用户名与邮箱

~~~sh
git config --global --list
~~~

配置用户名：

~~~sh
git config--global user.name '五月的夏天'
~~~

配置邮箱：

~~~sh
git config--global user.email '11111111@163.com'
~~~

### 2.2 clone类：

克隆项目到本地:

clone会做如下操作。1、pull操作 拉取代码。2、初始化本地仓库。3、创建远仓别名(origin)

~~~sh
git clone 远程仓库链接
~~~

克隆指定分支:

```sh
git clone -b 远分支 远链接
```

### 2.3 查看提交类：

查看详细的提交信息

~~~sh
git log
~~~

用一行、图像显示所有分支的提交情况

```sh
git log --all --graph --oneline 
```

查看某个人的提交情况：

~~~sh
git log --author='五月的夏天'
~~~

显示历史所有的(包括其它人)提交情况

```sh
git reflog
```

### 2.4 删除类

git删除文件：与使用鼠标手动删除文件不同，git命令删除使用git status查看就已经为绿色

~~~sh
git rm demo3.html
~~~

删除暂存区的文件与文件夹：

~~~sh
git rm --cached hello.txt
~~~

~~~sh
git rm -r --cached 文件夹
~~~

具体地，这个命令的各部分含义如下：

- `git rm`: 这是 Git 的删除文件命令。
- `--cached`: 这个选项告诉 Git 只删除暂存区（索引）中的文件，而不删除工作目录中的文件。
- `[文件夹名]`: 这是你想要从暂存区中删除的文件夹的名称。
- -r 表示递归的删除文件夹

通过执行这个命令，你可以将文件夹及其内容从 Git 的版本历史中移除，但仍然保留在你的工作目录中。

请注意，这个命令只会影响暂存区中的文件，如果你已经将这个文件夹提交到版本历史中，那么它将继续存在于历史快照中，直到你执行一次提交，将删除操作推送到远程仓库。

要**清空 Git 暂存区**中的所有文件，你可以使用以下命令：

1.

~~~sh
git rm -r --cached *
~~~

使用后再次git add就能够忽略.gitignore中的文件

2.

```shell
git reset
```

这将取消将所有文件从工作目录添加到暂存区的操作，暂存区将为空。文件仍将保留在你的工作目录中，但它们不再处于暂存状态。

### 2.5 提交命令

添加所有文件到暂存区并且提交到本地

```sh
git commit -a -m '注释'
```

只提交某一个文件到本地库中：

~~~sh
git commit -m '提交了一个文件' hello.txt
~~~

提交使用文件到本地仓库:

~~~sh
git commit -m '注释'
~~~



### 2.6 分支类命令:

#### 2.6.1 基本命令

```sh
创建分支:
git branch 分支名 

查看分支:
git branch -v 

切换分支:
git checkout 分支名

注意：指定一个分支(如:hot-fix)合并到当前的分支(master)上,master分支的代码会改变,只有一个分支进行了修改的情况下，不会出现冲突,合并之后hot-fix分支仍然存在且内容不变。
git merge 分支名(hot-fix)

删除分支：
git branch -d 分支名

```

#### 2.6.2 关于冲突：

**冲突产生的原因：**
合并分支时，两个分支对同一个文件都有修改记录时。Gt无法替我们决定使用哪一个。必须人为决定新代码内容。

**如何解决冲突：**1.git status找到发生冲突的文件 ,自己进行选择，保留那部分代码 2. 删除这些字符：<<<<< HEAD                      =============               >>>>>>3.git add和git commit(注意：不能够这样提交：git commit -m ' ' 冲突文件)到本地仓库

(1.)merge合并：并不合并分支，merge只把两个分支不冲突的提交进行合并，两个分支仍然可以提交新的文件
(2).git merge test 把test分支中不冲突的提交合并到master中(test分支不变，只把test分支中与master分支不冲突的提交给拷贝到master分支，然后再连线。)
(3.)发生冲突时：直接在本分支解决冲突(修改文件，因为在master进行合并，只有master分支被修改)后提交



#### 2.6.3 其他命令 变基rebase、cherry-pick优选：

变基rebase
git rebase master ->把当前分支变基到master分支中，相同的文件合并在master分支中，不同的文件以master的最新提交作为起点，把两个分支合并为一个分支，两个分支仍然可以提交新的文件

cherry-pick优选：
git cherry-pick commit哈希码 把对应的提交拷贝过来作为新的提交提交到本分支中

### 2.7 基本命令

- git init 初始化本地库

- git satus 查看本地库的状态 

- git remote add 远程仓库名字 https链接
- git add 文件
- git commit -m '注释'
- git pull 远仓名 远分支
- git push 远仓名 本分支：远分支
- git reset --hard 版本号

## 3 远程仓库的详细操作

### 3.1 详细操作

查看远仓名

```sh
git remote -v 
```

添加远程仓库别名

~~~sh
git remote add 远程仓库名字 https链接
~~~

push

`git push` 命令通常用于将本地分支的更改推送到远程分支，以便将远程分支更新为与本地分支一致。

这意味着，如果本地分支**领先于**远程分支，推送操作将会将本地的提交应用到远程分支，使其更新为与本地分支相同。

即：**本地仓库比远程仓库多一个提交时，就能够直接push成功**

~~~sh
git push (https/ssh)链接 本分支：远分支
~~~



pull操作，会把拉取到的代码自动提交到本地库，此时本地库与远程库保持一致(使用git status可查 注意：工作区中可能还有代码没有提交)

`git pull` 命令用于从远程仓库获取最新的更改并将它们合并到你的本地分支。这个命令通常执行以下操作：

1. **获取（Fetch）**：首先，`git pull` 会连接到远程仓库（通常是默认的远程仓库 `origin`），并获取远程分支的最新提交。这是一个只读操作，它会将远程仓库的提交下载到你的本地仓库，但不会自动合并这些提交到你的当前分支。
2. **合并（Merge）**：接下来，`git pull` 会尝试将获取的远程分支的提交合并到你的当前分支。这可能会导致快进合并（Fast-Forward Merge）或者合并提交（Merge Commit），具体取决于你的本地分支与远程分支之间的差异。
3. **冲突解决（Conflict Resolution）**：如果合并中出现冲突，你需要手动解决这些冲突。冲突通常发生在你和其他人同时修改了相同的文件或代码部分时。

~~~sh
git pull 远仓名 远分支
~~~

clone，clone会做如下操作。1、pull操作 拉取代码。2、初始化本地仓库。3、创建远仓别名(origin)

~~~sh
git clone https链接/ssh链接
~~~



### 3.2 使用ssh进行操作：

在本地生成公钥与私钥:

使用ssh免密协议 + rsa非对称加密算法 对绑定这个邮箱的账户生成公钥与私钥

公钥与私钥保存在C:\Users\用户\ .ssh 文件夹中，把公钥保存在github后，在这台电脑上面登录邮箱绑定的账号或者使用ssh链接clone项目时，就不需要密码就能够登录了，github会自动找到这台电脑中的私钥，然后进行登录。

~~~sh
[注意：这里-C这个参数是大写的C,在C:\Users\用户目录下面使用git命令行运行，会自动创建.ssh目录存放公钥与私钥]
ssh-keygen -t rsa -C 邮箱
~~~

### 3.3 远程仓库的冲突

a与b先后从中央仓库拉取代码到本地，a修改了test.java后提交到了本地，然后push到了远程仓库，b在a提交后也修改了test.java文件，提交到本地仓库后，b也进行push操作，但是在b修改test.java的时间里，a已经给远程仓库添加了新的提交，所以b需要从远程仓库pull拉取最新的分支到本地，记为分支1，b原来本地的分支记为分支2，然后执行pull操作包含的合并分支操作，合并分支1与分支2，但是因为两个分支都对test.java文件（同一行？）进行了修改，git无法判断保留哪一些，所以发生了冲突，b与a进行讨论后修改了代码，重新提交到本地后冲突解决，分支1与分支2成功合并，b再把合并好的分支push到远程仓库，b本地的分支提交数量比远程仓库的分支（即分支1）多一个提交（即：解决冲突的那个提交），所以可以成功push到远程仓库，覆盖原来的提交。



## 4 git常见报错与解决方法

### 4.1 使用git push代码到github上时报错：OpenSSL SSL_read: Connection was reset, errno 10054

(此时又必须开着vpn才能访问到github)

参考网上的回答，成功解决问题：

修改设置，解除ssl验证git config --global http.sslVerify "false" 此时，再执行git操作即可。

注：设置后关闭当前git窗口，重新打开再执行git操作
